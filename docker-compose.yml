services:
  backend:
    build:
      context: .
      dockerfile: apps/backend/Dockerfile
    environment:
      NODE_ENV: production
      PORT: 8000
      FRONTEND_URL: ${FRONTEND_URL:-http://localhost:3000}
      DATABASE_URL: ${DATABASE_URL:?DATABASE_URL is required}
      ADMIN_EMAIL: ${ADMIN_EMAIL:?ADMIN_EMAIL is required}
      ADMIN_PASSWORD: ${ADMIN_PASSWORD:-}
      ADMIN_PASSWORD_HASH: ${ADMIN_PASSWORD_HASH:-}
      JWT_SECRET: ${JWT_SECRET:?JWT_SECRET is required}
      LICENSE_TOKEN_SECRET: ${LICENSE_TOKEN_SECRET:?LICENSE_TOKEN_SECRET is required}
      DB_SSL_MODE: ${DB_SSL_MODE:-require}
    expose:
      - "8000"
    restart: unless-stopped

  frontend:
    build:
      context: .
      dockerfile: apps/frontend/Dockerfile
    depends_on:
      - backend
    expose:
      - "80"
    restart: unless-stopped
